<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜ä¸­äº’è¯„</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="not">
        <p>ä¸Šæ¬¡æ›´æ–°: 2024/4/24 11:12PM ç¾è¥¿</p>
        <p>è¯·åˆ·æ–°é¡µé¢æ¥æŸ¥çœ‹æœ€æ–°è¡¨æ ¼</p>
    </div>
    <h1>ç¾åŒºğŸ‡ºğŸ‡¸</h1>
    <h2>*æ­¤è¡¨ä»…ä½œä¸ºæ–°ç”Ÿæ‹©æ ¡å‚è€ƒï¼Œå¸Œæœ›è·å¾—ä¿¡æ¯çš„å­¦æ ¡å¯ä»¥å¡«å†™é—®å·ï¼Œæ„Ÿè°¢ç•™è¨€çš„å­¦é•¿å­¦å§ä»¬! è¯·åªåœ¨å­¦ç”Ÿä¸­ä¼ !                    </h1>
    </h2>
    <div id="table-container">
        <table id="excel-table">
            <!-- Table content will be generated here -->
        </table>
    </div>
    <div class="watermark">
        <!-- Watermark content -->
    </div>
    <script>
        const tableContainer = document.getElementById("table-container");
        const excelTable = document.getElementById("excel-table");

        tableContainer.scrollTop = 0;

        fetch("meiqu.json")
            .then((response) => response.json())
            .then((data) => {
            jsonData = data;
            generateTableFromJSON();
            })
            .catch((error) => console.error("Error loading JSON data:", error));
        
            function generateTableFromJSON() {
                let tableContent = "";
                let rowNum = 1; // Counter for row numbers

                // Calculate the maximum number of items in any row
                const maxItems = Math.max(
                    ...jsonData.map((obj) => Object.values(obj).flatMap((arr) => arr.length)),
                );

                jsonData.forEach((obj) => {
                    for (const title in obj) {
                    if (Object.hasOwnProperty.call(obj, title)) {
                        // Start new row for each title and its content
                        tableContent += "<tr>";
                        // Add row number column with a custom class
                        tableContent += `<td class="row-number">${rowNum}</td>`;
                        rowNum++; // Increment row number counter
                        // Title in second column
                        tableContent += `<td><strong>${title}</strong></td>`;
                        // Content in subsequent columns
                        obj[title].forEach((item) => {
                        tableContent += `<td>${item}</td>`;
                        });
                        // Add empty cells if the row is not long enough
                        for (let i = obj[title].length; i < maxItems; i++) {
                        tableContent += "<td></td>";
                        }
                        tableContent += "</tr>";
                    }
                    }
                });

                document.getElementById("excel-table").innerHTML = tableContent;
                }
            
                tableContainer.addEventListener("scroll", () => {
                const scrollTop = tableContainer.scrollTop;
                document.querySelectorAll(".sticky-column").forEach((column) => {
                    column.style.transform = `translateY(${scrollTop}px)`;
                });
                });
        </script>
</body>
</html>